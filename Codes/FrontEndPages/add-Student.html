<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إضافة طالب جديد - نظام متابعة حفظ القرآن</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background: #f8f9fa;
        }

        .main-container {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .container-header {
            border-bottom: 2px solid #4a90e2;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
        }

        .form-section {
            border-radius: 8px;
            border-top: 3px solid #4a90e2;
            box-shadow: 0 1px 8px rgba(0, 0, 0, 0.05);
            padding: 1rem;
            margin-bottom: 1rem;
            background: #f8f9fa;
        }

        .section-title {
            color: #4a90e2;
            margin-bottom: 0.8rem;
            font-weight: 500;
        }

        .btn-primary {
            background-color: #4a90e2;
            border-color: #4a90e2;
        }

        .selected-day {
            background: #4a90e2;
            color: white;
        }

        .progress-bar {
            background-color: #4a90e2;
        }
    </style>
</head>

<body>
    <div class="container py-3">
        <div class="main-container">
            <!-- Header -->
            <div class="container-header d-flex justify-content-between align-items-center">
                <h2 class="text-primary m-0">إضافة طالب جديد</h2>
                <a href="StudentEvaluation.html" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-list"></i> قائمة التقييمات
                </a>
            </div>

            <!-- Progress Steps -->
            <div class="row mb-3 text-center">
                <div class="col-md-4">
                    <div class="p-2 bg-primary text-white rounded">
                        <i class="fas fa-user me-1"></i> المعلومات الشخصية
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="p-2 bg-secondary text-white rounded">
                        <i class="fas fa-book-open me-1"></i> الحفظ السابق
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="p-2 bg-secondary text-white rounded">
                        <i class="fas fa-tasks me-1"></i> خطة الحفظ
                    </div>
                </div>
            </div>

            <!-- Form -->
            <form id="addStudentForm">
                <!-- Personal Information Section -->
                <div class="form-section">
                    <h5 class="section-title"><i class="fas fa-user me-2"></i>المعلومات الشخصية</h5>
                    <div class="row mb-3">
                        <div class="col-md-6 mb-2">
                            <label for="studentName" class="form-label">اسم الطالب</label>
                            <input type="text" class="form-control" id="studentName"
                                placeholder="أدخل اسم الطالب بالكامل" required>
                        </div>
                        <div class="col-md-3 mb-2">
                            <label for="studentAge" class="form-label">العمر</label>
                            <input type="number" class="form-control" id="studentAge" placeholder="العمر" min="5"
                                max="80" required>
                        </div>
                        <div class="col-md-3 mb-2">
                            <label for="studentGender" class="form-label">الجنس</label>
                            <select class="form-select" id="studentGender" required>
                                <option value="" selected disabled>اختر</option>
                                <option value="ذكر">ذكر</option>
                                <option value="أنثى">أنثى</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6 mb-2">
                            <label for="nationality" class="form-label">الجنسية</label>
                            <select class="form-select" id="nationality" required>
                                <option value="" selected disabled>اختر الجنسية</option>
                                <option value="سعودي">سعودي</option>
                                <option value="مصري">مصري</option>
                                <option value="سوري">سوري</option>
                                <option value="يمني">يمني</option>
                                <option value="أخرى">أخرى</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-2">
                            <label for="registrationDate" class="form-label">تاريخ التسجيل</label>
                            <input type="date" class="form-control" id="registrationDate" required>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-2">
                            <label for="parentPhone" class="form-label">رقم هاتف ولي الأمر</label>
                            <input type="tel" class="form-control" id="parentPhone" placeholder="05xxxxxxxx"
                                pattern="[0-9]{10}">
                        </div>
                        <div class="col-md-6 mb-2">
                            <label class="form-label">أيام التسميع</label>
                            <div class="d-flex flex-wrap gap-1">
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="السبت">السبت</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الأحد">الأحد</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الاثنين">الاثنين</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الثلاثاء">الثلاثاء</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الأربعاء">الأربعاء</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الخميس">الخميس</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary day-btn"
                                    data-day="الجمعة">الجمعة</button>
                            </div>
                            <input type="hidden" id="selectedDays" name="selectedDays">
                        </div>
                    </div>
                </div>

                <!-- Previous Memorization Section -->
                <div class="form-section">
                    <h5 class="section-title"><i class="fas fa-book-open me-2"></i>الحفظ السابق</h5>
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="hasMemorization"
                                    id="hasMemorizationYes" value="yes">
                                <label class="form-check-label" for="hasMemorizationYes">يحفظ سابقاً</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="hasMemorization"
                                    id="hasMemorizationNo" value="no" checked>
                                <label class="form-check-label" for="hasMemorizationNo">لا يحفظ</label>
                            </div>
                        </div>
                    </div>

                    <div id="memorizationDetailsContainer" class="d-none">
                        <div class="row mb-3">
                            <div class="col-md-6 mb-2">
                                <label class="form-label">من</label>
                                <div class="input-group">
                                    <select class="form-select" id="fromSurah">
                                        <option value="">اختر السورة</option>
                                        <!-- Populated by JS -->
                                    </select>
                                    <input type="number" class="form-control" id="fromVerse" placeholder="الآية"
                                        min="1">
                                </div>
                            </div>
                            <div class="col-md-6 mb-2">
                                <label class="form-label">إلى</label>
                                <div class="input-group">
                                    <select class="form-select" id="toSurah">
                                        <option value="">اختر السورة</option>
                                        <!-- Populated by JS -->
                                    </select>
                                    <input type="number" class="form-control" id="toVerse" placeholder="الآية" min="1">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12">
                                <label class="form-label">مستوى الإتقان</label>
                                <div class="d-flex gap-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="proficiencyLevel"
                                            id="proficiencyExcellent" value="ممتاز">
                                        <label class="form-check-label" for="proficiencyExcellent">ممتاز</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="proficiencyLevel"
                                            id="proficiencyVeryGood" value="جيد جدا">
                                        <label class="form-check-label" for="proficiencyVeryGood">جيد جدا</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="proficiencyLevel"
                                            id="proficiencyGood" value="جيد">
                                        <label class="form-check-label" for="proficiencyGood">جيد</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="proficiencyLevel"
                                            id="proficiencyWeak" value="ضعيف">
                                        <label class="form-check-label" for="proficiencyWeak">ضعيف</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Memorization Plan Section -->
                <div class="form-section">
                    <h5 class="section-title"><i class="fas fa-tasks me-2"></i>خطة الحفظ</h5>
                    <div class="row mb-3">
                        <div class="col-md-4 mb-2">
                            <label class="form-label">الحفظ الجديد (آيات)</label>
                            <input type="number" class="form-control" id="newMemorizationAmount" min="1" max="20"
                                placeholder="مثال: 5">
                            <small class="text-muted">عدد الآيات اليومية للحفظ الجديد</small>
                        </div>
                        <div class="col-md-4 mb-2">
                            <label class="form-label">المراجعة الصغرى (صفحات)</label>
                            <input type="number" class="form-control" id="smallRevisionAmount" min="1" max="10"
                                placeholder="مثال: 2">
                            <small class="text-muted">عدد الصفحات اليومية للمراجعة</small>
                        </div>
                        <div class="col-md-4 mb-2">
                            <label class="form-label">المراجعة الكبرى (صفحات)</label>
                            <input type="number" class="form-control" id="largeRevisionAmount" min="1" max="20"
                                placeholder="مثال: 5">
                            <small class="text-muted">عدد الصفحات اليومية للمراجعة</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <label class="form-label">ملاحظات إضافية</label>
                            <textarea class="form-control" id="notes" rows="2"
                                placeholder="أي ملاحظات إضافية حول الطالب أو خطة الحفظ..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Submit Buttons -->
                <div class="d-flex justify-content-center gap-2 mt-3">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-1"></i> حفظ وإضافة الطالب
                    </button>
                    <button type="button" class="btn btn-outline-primary" id="saveAndAddAnother">
                        <i class="fas fa-plus me-1"></i> حفظ وإضافة طالب آخر
                    </button>
                    <button type="reset" class="btn btn-outline-danger">
                        <i class="fas fa-times me-1"></i> إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 5">
        <div id="successToast" class="toast align-items-center text-white bg-success border-0" role="alert"
            aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body">
                    <i class="fas fa-check-circle me-2"></i> تم حفظ معلومات الطالب بنجاح
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Surah list - complete list of all 114 Surahs
        const surahs = [
            { name: "الفاتحة", verses: 7 },
            { name: "البقرة", verses: 286 },
            { name: "آل عمران", verses: 200 },
            { name: "النساء", verses: 176 },
            { name: "المائدة", verses: 120 },
            { name: "الأنعام", verses: 165 },
            { name: "الأعراف", verses: 206 },
            { name: "الأنفال", verses: 75 },
            { name: "التوبة", verses: 129 },
            { name: "يونس", verses: 109 },
            { name: "هود", verses: 123 },
            { name: "يوسف", verses: 111 },
            { name: "الرعد", verses: 43 },
            { name: "إبراهيم", verses: 52 },
            { name: "الحجر", verses: 99 },
            { name: "النحل", verses: 128 },
            { name: "الإسراء", verses: 111 },
            { name: "الكهف", verses: 110 },
            { name: "مريم", verses: 98 },
            { name: "طه", verses: 135 },
            { name: "الأنبياء", verses: 112 },
            { name: "الحج", verses: 78 },
            { name: "المؤمنون", verses: 118 },
            { name: "النور", verses: 64 },
            { name: "الفرقان", verses: 77 },
            { name: "الشعراء", verses: 227 },
            { name: "النمل", verses: 93 },
            { name: "القصص", verses: 88 },
            { name: "العنكبوت", verses: 69 },
            { name: "الروم", verses: 60 },
            { name: "لقمان", verses: 34 },
            { name: "السجدة", verses: 30 },
            { name: "الأحزاب", verses: 73 },
            { name: "سبأ", verses: 54 },
            { name: "فاطر", verses: 45 },
            { name: "يس", verses: 83 },
            { name: "الصافات", verses: 182 },
            { name: "ص", verses: 88 },
            { name: "الزمر", verses: 75 },
            { name: "غافر", verses: 85 },
            { name: "فصلت", verses: 54 },
            { name: "الشورى", verses: 53 },
            { name: "الزخرف", verses: 89 },
            { name: "الدخان", verses: 59 },
            { name: "الجاثية", verses: 37 },
            { name: "الأحقاف", verses: 35 },
            { name: "محمد", verses: 38 },
            { name: "الفتح", verses: 29 },
            { name: "الحجرات", verses: 18 },
            { name: "ق", verses: 45 },
            { name: "الذاريات", verses: 60 },
            { name: "الطور", verses: 49 },
            { name: "النجم", verses: 62 },
            { name: "القمر", verses: 55 },
            { name: "الرحمن", verses: 78 },
            { name: "الواقعة", verses: 96 },
            { name: "الحديد", verses: 29 },
            { name: "المجادلة", verses: 22 },
            { name: "الحشر", verses: 24 },
            { name: "الممتحنة", verses: 13 },
            { name: "الصف", verses: 14 },
            { name: "الجمعة", verses: 11 },
            { name: "المنافقون", verses: 11 },
            { name: "التغابن", verses: 18 },
            { name: "الطلاق", verses: 12 },
            { name: "التحريم", verses: 12 },
            { name: "الملك", verses: 30 },
            { name: "القلم", verses: 52 },
            { name: "الحاقة", verses: 52 },
            { name: "المعارج", verses: 44 },
            { name: "نوح", verses: 28 },
            { name: "الجن", verses: 28 },
            { name: "المزمل", verses: 20 },
            { name: "المدثر", verses: 56 },
            { name: "القيامة", verses: 40 },
            { name: "الإنسان", verses: 31 },
            { name: "المرسلات", verses: 50 },
            { name: "النبأ", verses: 40 },
            { name: "النازعات", verses: 46 },
            { name: "عبس", verses: 42 },
            { name: "التكوير", verses: 29 },
            { name: "الانفطار", verses: 19 },
            { name: "المطففين", verses: 36 },
            { name: "الانشقاق", verses: 25 },
            { name: "البروج", verses: 22 },
            { name: "الطارق", verses: 17 },
            { name: "الأعلى", verses: 19 },
            { name: "الغاشية", verses: 26 },
            { name: "الفجر", verses: 30 },
            { name: "البلد", verses: 20 },
            { name: "الشمس", verses: 15 },
            { name: "الليل", verses: 21 },
            { name: "الضحى", verses: 11 },
            { name: "الشرح", verses: 8 },
            { name: "التين", verses: 8 },
            { name: "العلق", verses: 19 },
            { name: "القدر", verses: 5 },
            { name: "البينة", verses: 8 },
            { name: "الزلزلة", verses: 8 },
            { name: "العاديات", verses: 11 },
            { name: "القارعة", verses: 11 },
            { name: "التكاثر", verses: 8 },
            { name: "العصر", verses: 3 },
            { name: "الهمزة", verses: 9 },
            { name: "الفيل", verses: 5 },
            { name: "قريش", verses: 4 },
            { name: "الماعون", verses: 7 },
            { name: "الكوثر", verses: 3 },
            { name: "الكافرون", verses: 6 },
            { name: "النصر", verses: 3 },
            { name: "المسد", verses: 5 },
            { name: "الإخلاص", verses: 4 },
            { name: "الفلق", verses: 5 },
            { name: "الناس", verses: 6 }
        ];

        // Populate Surah dropdowns
        function populateSurahs() {
            const fromSurahSelect = document.getElementById('fromSurah');
            const toSurahSelect = document.getElementById('toSurah');

            surahs.forEach(surah => {
                const option = document.createElement('option');
                option.value = surah.name;
                option.textContent = surah.name;
                fromSurahSelect.appendChild(option.cloneNode(true));
                toSurahSelect.appendChild(option.cloneNode(true));
            });
        }

        // Handle memorization radio buttons
        function setupMemorizationToggle() {
            document.querySelectorAll('input[name="hasMemorization"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    const memorizationDetailsContainer = document.getElementById('memorizationDetailsContainer');
                    if (this.value === 'yes') {
                        memorizationDetailsContainer.classList.remove('d-none');
                    } else {
                        memorizationDetailsContainer.classList.add('d-none');
                    }
                });
            });
        }

        // Handle day selection buttons
        function setupDaySelection() {
            document.querySelectorAll('.day-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    this.classList.toggle('selected-day');
                    this.classList.toggle('btn-outline-secondary');
                    this.classList.toggle('btn-primary');
                    updateSelectedDays();
                });
            });
        }

        function updateSelectedDays() {
            const selectedDays = Array.from(document.querySelectorAll('.day-btn.selected-day')).map(btn => btn.dataset.day);
            document.getElementById('selectedDays').value = selectedDays.join(',');
        }
        // Form submission
        function setupFormSubmission() {
            document.getElementById('addStudentForm').addEventListener('submit', function (event) {
                event.preventDefault();

                // Collect form data
                const formData = {
                    personalInfo: {
                        name: document.getElementById('studentName').value,
                        age: document.getElementById('studentAge').value,
                        gender: document.getElementById('studentGender').value,
                        nationality: document.getElementById('nationality').value,
                        registrationDate: document.getElementById('registrationDate').value,
                        parentPhone: document.getElementById('parentPhone').value,
                        attendanceDays: document.getElementById('selectedDays').value
                    },
                    previousMemorization: {
                        hasMemorization: document.querySelector('input[name="hasMemorization"]:checked').value,
                        fromSurah: document.getElementById('fromSurah').value,
                        fromVerse: document.getElementById('fromVerse').value,
                        toSurah: document.getElementById('toSurah').value,
                        toVerse: document.getElementById('toVerse').value,
                        proficiencyLevel: document.querySelector('input[name="proficiencyLevel"]:checked')?.value || ''
                    },
                    memorizationPlan: {
                        newMemorizationAmount: document.getElementById('newMemorizationAmount').value,
                        smallRevisionAmount: document.getElementById('smallRevisionAmount').value,
                        largeRevisionAmount: document.getElementById('largeRevisionAmount').value,
                        notes: document.getElementById('notes').value
                    }
                };

                // Show success toast
                const successToast = new bootstrap.Toast(document.getElementById('successToast'));
                successToast.show();

                // Here you would typically send the form data to a server
                console.log("Form submitted successfully", formData);
            });
            // Save and add another button
            document.getElementById('saveAndAddAnother').addEventListener('click', function () {
                // Trigger form validation
                if (!document.getElementById('addStudentForm').checkValidity()) {
                    document.getElementById('addStudentForm').reportValidity();
                    return;
                }

                // Show success notification
                const successToast = new bootstrap.Toast(document.getElementById('successToast'));
                successToast.show();

                // Reset form
                document.getElementById('addStudentForm').reset();
                document.querySelectorAll('.day-btn.selected-day').forEach(btn => {
                    btn.classList.remove('selected-day');
                    btn.classList.remove('btn-primary');
                    btn.classList.add('btn-outline-secondary');
                });

                // Hide memorization details if they were visible
                document.getElementById('memorizationDetailsContainer').classList.add('d-none');

                // Reset hidden fields
                document.getElementById('selectedDays').value = '';
            });
        }
        // Validate verse numbers based on selected Surah
        function setupVerseValidation() {
            const fromSurahSelect = document.getElementById('fromSurah');
            const fromVerseInput = document.getElementById('fromVerse');
            const toSurahSelect = document.getElementById('toSurah');
            const toVerseInput = document.getElementById('toVerse');

            fromSurahSelect.addEventListener('change', function () {
                const selectedSurah = surahs.find(s => s.name === this.value);
                if (selectedSurah) {
                    fromVerseInput.max = selectedSurah.verses;
                    fromVerseInput.placeholder = `الآية (1-${selectedSurah.verses})`;
                }
            });

            toSurahSelect.addEventListener('change', function () {
                const selectedSurah = surahs.find(s => s.name === this.value);
                if (selectedSurah) {
                    toVerseInput.max = selectedSurah.verses;
                    toVerseInput.placeholder = `الآية (1-${selectedSurah.verses})`;
                }
            });
        }
        // Setup progress steps navigation
        function setupProgressSteps() {
            const steps = document.querySelectorAll('.row.mb-3.text-center .col-md-4 div');
            const sections = document.querySelectorAll('.form-section');

            // Set default date to today
            document.getElementById('registrationDate').valueAsDate = new Date();
        }
        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function () {
            populateSurahs();
            setupMemorizationToggle();
            setupDaySelection();
            setupFormSubmission();
            setupVerseValidation();
            setupProgressSteps();
        });
    </script>
</body>

</html>